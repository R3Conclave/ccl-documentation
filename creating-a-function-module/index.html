
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.6">
    
    
      
        <title>Creating a Function Module - Conclave Cloud User Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#creating-a-function-module-using-ccl" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Conclave Cloud User Guide" class="md-header-nav__button md-logo" aria-label="Conclave Cloud User Guide">
      
  <img src="../assets/cloud-logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Conclave Cloud User Guide
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Creating a Function Module
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Conclave Cloud User Guide" class="md-nav__button md-logo" aria-label="Conclave Cloud User Guide">
      
  <img src="../assets/cloud-logo.svg" alt="logo">

    </a>
    Conclave Cloud User Guide
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../what-is-conclave-cloud/" class="md-nav__link">
        What is Conclave Cloud?
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../conclave-cloud-concepts/" class="md-nav__link">
        Conclave Cloud Concepts
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
      
      <label class="md-nav__link" for="nav-4">
        Conclave Functions
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Conclave Functions" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Conclave Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../javascript-in-conclave-functions/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../creating-your-first-function/" class="md-nav__link">
        Creating your first function
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Creating a Function Module
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Creating a Function Module
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-new-function-module" class="md-nav__link">
    Creating a new Function Module
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-function-to-the-module" class="md-nav__link">
    Adding a function to the module
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-the-module-build" class="md-nav__link">
    Preparing the module build
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    Testing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-your-module" class="md-nav__link">
    Uploading your module
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#targeting-a-different-conclave-cloud-project" class="md-nav__link">
    Targeting a different Conclave Cloud Project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-modules-using-npm" class="md-nav__link">
    Adding modules using npm
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4" >
      
      <label class="md-nav__link" for="nav-4-4">
        Built-in Modules
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Built-in Modules" data-md-level="2">
        <label class="md-nav__title" for="nav-4-4">
          <span class="md-nav__icon md-icon"></span>
          Built-in Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fetch/" class="md-nav__link">
        Fetch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../crypto/" class="md-nav__link">
        Crypto
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../conclavepass-sample/" class="md-nav__link">
        ConclavePass Sample using Conclave Functions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../invoking-your-first-function-with-js-sdk/" class="md-nav__link">
        Tutorial - Invoking your function using Conclave Cloud JS SDK
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-new-function-module" class="md-nav__link">
    Creating a new Function Module
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-function-to-the-module" class="md-nav__link">
    Adding a function to the module
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-the-module-build" class="md-nav__link">
    Preparing the module build
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    Testing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-your-module" class="md-nav__link">
    Uploading your module
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#targeting-a-different-conclave-cloud-project" class="md-nav__link">
    Targeting a different Conclave Cloud Project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-modules-using-npm" class="md-nav__link">
    Adding modules using npm
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="creating-a-function-module-using-ccl">Creating a Function Module using <code>ccl</code></h1>
<p>A Conclave Function needs to be uploaded in a single JavaScript file. However,
you can use a transpiler and a packing tool to take a multi-file project using any
language that can be transpiled into JavaScript, transpile it then pack it into
a single file for upload.</p>
<p>When configuring a module in this way, it can be quite difficult to get the
correct configuration in order to support the version of JavaScript and export
mechanism that Conclave Functions uses. For that reason, the Conclave Cloud
<code>ccl</code> tool provides commands to create both TypeScript and JavaScript modules as
well as to add new functions to existing modules.</p>
<h2 id="creating-a-new-function-module">Creating a new Function Module</h2>
<p>Firstly 
<a href="https://docs.npmjs.com/downloading-and-installing-node-js-and-npm">ensure you have the <code>npm</code> tool installed</a> 
to allow the Function Module to be managed and built.</p>
<p>Open a terminal or command prompt in the directory where you want to create your
module and run the following command:</p>
<pre><code>ccl module new --language=[language] --project=[project name or id] --root=[module_name]
</code></pre>

<p>The <code>language</code> value can be either <code>typescript</code> or <code>javascript</code> depending on the
type of module you want to create.</p>
<p>The <code>project name or id</code> should be set to the project that you will be uploading
the function module into. This can be changed after the module has been created
by editing the configuration files. If you have used the command <code>ccl save</code> to
set a default project ID then you can omit this parameter.</p>
<p>The <code>module_name</code> is the name of the module and will be used as the name for the
directory containing the module.</p>
<p>For example, to create a TypeScript module named <code>mymodule</code> in the current
default project, use the following command:</p>
<pre><code>ccl module new --language=typescript --root=mymodule
</code></pre>

<p>The generated module will contain the following files:</p>
<table>
<thead>
<tr>
<th>Path</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>cclmodule.json</td>
<td>The configuration of the module during creation. This information will be used by <code>ccl</code> when running commands to modify the module.</td>
</tr>
<tr>
<td>package.json</td>
<td>The npm configuration file that contains metadata and dependencies for the module.</td>
</tr>
<tr>
<td>README.md</td>
<td>Information about the generated module, including information about how to build and upload the module to Conclave Cloud.</td>
</tr>
<tr>
<td>tsconfig.json</td>
<td>For TypeScript projects, contains the configuration of the TypeScript transpiler, pre-configured to work with Conclave Cloud.</td>
</tr>
<tr>
<td>webpack.config.js</td>
<td>Webpack configuration file that assembles all source modules and dependencies into a single JavaScript file for upload to Conclave Cloud.</td>
</tr>
<tr>
<td>src/index.ts</td>
<td>A code module that exports the functions defined in the module. This will be updated by <code>ccl</code> each time you add a function to the module.</td>
</tr>
<tr>
<td>test/test.js</td>
<td>A JavaScript file that can be edited to test the functions within your module.</td>
</tr>
<tr>
<td>test/template/polyfill.js</td>
<td>A JavaScript file that emulates the JavaScript modules supported in the Conclave Functions runtime environment.</td>
</tr>
</tbody>
</table>
<h2 id="adding-a-function-to-the-module">Adding a function to the module</h2>
<p>When you first create a function module it is created as an empty module that
does not contain any exported functions. In order to create a Conclave Function
you need to create a new function within the module.</p>
<p>From a terminal within the root directory of your module:</p>
<pre><code>ccl module add --name=[name of function]
</code></pre>

<p>For example, to create a function named <code>function1</code> in the <code>mymodule</code> module:</p>
<pre><code>cd mymodule
ccl module add --name=function1
</code></pre>

<p>The command will generate a new source file named <code>src/functions/function1.ts</code>
which contains the following placeholder code:</p>
<pre><code class="typescript">// Auto-generated function code, generated with the Conclave Cloud ccl tool.
// Replace the implementation below with your own code.
export async function function1(arg1: string, arg2: string): Promise&lt;string&gt; {
    return arg1 + arg2;
}
</code></pre>

<p>Replace the code in the function with your own implementation.</p>
<h2 id="preparing-the-module-build">Preparing the module build</h2>
<p>Like with any other <code>npm</code> module, you need to install the tools and dependencies
for the module before it can be built or uploaded.</p>
<p>Run this command from the root directory of the module.</p>
<pre><code>npm install
</code></pre>

<h2 id="testing">Testing</h2>
<p>An empty test module has been provided in <code>test/test.js</code>. Modify this file to exercise your
Conclave Functions before uploading. You can run the tests with the following command:</p>
<pre><code>npm run test
</code></pre>

<h2 id="uploading-your-module">Uploading your module</h2>
<p>Once you have added and implemented your functions you can use <code>npm</code> to upload
them to Conclave Cloud. They will be uploaded to the project you defined when
creating the module unless you have edited the configuration to use a different
project.</p>
<p>Run this command to upload to the module project:</p>
<pre><code>npm run upload
</code></pre>

<h2 id="targeting-a-different-conclave-cloud-project">Targeting a different Conclave Cloud Project</h2>
<p>If you wish to change the project that the module is targeting then you must edit the 
project ID in <code>cclmodule.json</code> and the entries in the upload script in
<code>package.json</code>.</p>
<h2 id="adding-modules-using-npm">Adding modules using npm</h2>
<p>You can add third party dependencies to your module using the <code>npm</code> tool, as
long as they do not depend on capabilities that are not present in Conclave
Functions (such as <code>fs</code> file support).</p>
<p>For example, to add the <code>CryptoJS</code> library to your module:</p>
<pre><code>npm install crypto-js
</code></pre>

<p>You can then use CryptoJS in your function module:</p>
<pre><code class="typescript">import {AES} from &quot;crypto-js&quot;;

export async function function1(arg1: string, arg2: string): Promise&lt;string&gt; {
    const encrypted = AES.encrypt(arg1 + arg2, crypto.getProjectKey());
    return encrypted.toString()
}
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../creating-your-first-function/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Creating your first function
              </div>
            </div>
          </a>
        
        
          <a href="../fetch/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Fetch
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.53cc9318.min.js"></script>
      <script src="../assets/javascripts/bundle.e9c9f54f.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>